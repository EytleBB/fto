<!DOCTYPE html>
<html>
<head>
    <title>图片与转盘网站</title>
    <style>
        /* 原有样式保持不变 */
        body { 
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            margin: 10px;
            cursor: pointer;
        }
        img {
            max-width: 100%;
            height: auto;
            margin-top: 20px;
        }

        /* 转盘新样式 */
        #roulette-container {
            position: relative;
            margin: 50px auto;
            width: 400px;
            height: 400px;
        }

        #roulette {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            transition: transform 3s cubic-bezier(0.25, 0.1, 0.25, 1);
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
        }

        .segment {
            position: absolute;
            width: 50%;
            height: 50%;
            left: 50%;
            top: 0;
            transform-origin: left bottom;
            clip-path: polygon(0 0, 100% 0, 100% 100%);
        }

        .segment-text {
            position: absolute;
            left: 60%;
            top: 15%;
            transform: translate(-50%, -50%) rotate(90deg);
            font-size: 16px;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px black;
            white-space: nowrap;
        }

        #pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 30px solid #ff4444;
            z-index: 100;
        }
    </style>
</head>
<body>
    <h1>选择一张图片</h1>
    <button onclick="showImage('image1.jpg')">显示图片 1</button>
    <button onclick="showImage('image2.jpg')">显示图片 2</button>
    <button onclick="openSettings()">打开转盘设置</button>

    <div id="image-container"></div>

    <div id="settings-modal" style="display: none;">
        <h3>设置转盘选项（用逗号分隔）</h3>
        <input type="text" id="roulette-options" placeholder="例如: 早餐,午餐,晚餐">
        <button onclick="saveOptions()">保存</button>
        <button onclick="closeSettings()">关闭</button>
    </div>

    <div id="roulette-container" style="display: none;">
        <div id="pointer"></div>
        <div id="roulette"></div>
        <button onclick="spin()" style="margin-top: 20px;">开始旋转</button>
        <div id="result"></div>
    </div>

    <script>
        // 图片显示功能
        function showImage(imageName) {
            const container = document.getElementById('image-container');
            container.innerHTML = `<img src="${imageName}" alt="显示的图片">`;
        }

        // 转盘功能
        let options = [];
        
        function openSettings() {
            document.getElementById('settings-modal').style.display = 'block';
            loadSavedOptions();
        }

        function closeSettings() {
            document.getElementById('settings-modal').style.display = 'none';
        }

        function saveOptions() {
            const input = document.getElementById('roulette-options').value;
            options = input.split(',').map(item => item.trim());
            if (options.length < 2) {
                alert("至少需要2个选项！");
                return;
            }
            localStorage.setItem('rouletteOptions', JSON.stringify(options));
            closeSettings();
            generateRoulette();
        }

        function loadSavedOptions() {
            const saved = localStorage.getItem('rouletteOptions');
            if (saved) {
                options = JSON.parse(saved);
                document.getElementById('roulette-options').value = options.join(', ');
            }
        }

        function generateRoulette() {
            const roulette = document.getElementById('roulette');
            roulette.innerHTML = '';
            
            const total = options.length;
            const angle = 360 / total;

            options.forEach((option, index) => {
                // 创建扇形
                const segment = document.createElement('div');
                segment.className = 'segment';
                segment.style.transform = `rotate(${index * angle}deg)`;
                segment.style.backgroundColor = `hsl(${(index * 360/total)}, 70%, 50%)`;

                // 添加文字
                const text = document.createElement('div');
                text.className = 'segment-text';
                text.textContent = option;
                text.style.transform = `translate(-50%, -50%) rotate(${angle/2 + 90}deg)`;

                segment.appendChild(text);
                roulette.appendChild(segment);
            });

            document.getElementById('roulette-container').style.display = 'block';
        }

        function spin() {
            const roulette = document.getElementById('roulette');
            const resultDiv = document.getElementById('result');
            
            // 重置旋转
            roulette.style.transform = 'rotate(0deg)';
            
            // 生成随机旋转（至少5圈）
            const randomAngle = Math.floor(Math.random() * 360) + 360 * 5;
            roulette.style.transform = `rotate(${-randomAngle}deg)`;
            
            // 计算最终结果
            setTimeout(() => {
                const finalAngle = (randomAngle % 360) * (Math.PI/180);
                const selectedIndex = Math.floor((finalAngle / (360 / options.length)) % options.length);
                resultDiv.textContent = `抽中结果：${options[options.length - 1 - selectedIndex]}`;
            }, 3000);
        }

        // 初始化加载保存的选项
        window.onload = function() {
            loadSavedOptions();
            if (options.length > 0) generateRoulette();
        }
    </script>
</body>
</html>
